<div class="flex">
  <div>
    <div class="emoji"><%= s.dbg.emoji_flag || '❓' %></div><h1 id="name"><%= s.name %></h1>
  </div>
  <div id="timeAgo">
    <span id="ts" data-ts="<%= s.ts %>"><%= timeAgo(s.ts) %></span>
    <div id="loader"></div>
    <div id="timer">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock-fill" viewBox="0 0 16 16">
        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"/>
      </svg>
    </div>
  </div>
</div>

<div class="bar">
  <div>
    <span>Players</span>
    <span id="p"<% if (s.players - s.bots > 0) { %> class="e" <% } %>><svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="me-1.5 size-5 text-green-400"><path d="M11.5 8A1.5 1.5 0 0 1 13 9.5v.5c0 2-1.9 4-5 4s-5-2-5-4v-.5A1.5 1.5 0 0 1 4.5 8zM8 1.5A2.7 2.7 0 1 1 8 7a2.7 2.7 0 0 1 0-5.5" fill="currentColor"></path></svg><i><%= (s.players - s.bots) %></i><% if (s.bots > 0) { %><span class="b">+<%= s.bots %></span><% } %>/<%= s.maxplayers %>
  </div>
  <div>
    <span>Map</span>
    <span id="map"><%= s.map %></span>
  </div>
  <div>
    <span>Game Mode</span>
    <span id="gm"><%= ['Standard', 'Deathmatch', 'Team Deathmatch', 'Construction', 'Zombies!'][s.gamemode] %></span>
  </div>
  <div>
    <span>Address</span>
    <span id="addr"><%= s.ip %>:<%= s.port %></span>
  </div>
  <% if (l != false) { %>
  <a href="/leaderboard/<%= s.ip %>:<%= s.port %>">
    <span>Leaderboard</span>
    <span>Visit Page</span>
  </a>
  <% } else { %>
  <div href="/leaderboard/<%= s.ip %>:<%= s.port %>">
    <span>Leaderboard</span>
    <span>Not Available</span>
  </div>
  <% } %>
</div>

<div class="fl">
  <div data-flag="lua" class="<%= s.lua ? 'enbl' : 'dsbl' %>">Lua scripts</div>
  <div data-flag="downloads" class="<%= s.downloads ? 'enbl' : 'dsbl' %>">Downloads</div>
  <div data-flag="offscreendamage" class="<%= s.offscreendamage ? 'enbl' : 'dsbl' %>">Off-Scn Dmg</div>
  <div data-flag="fow" class="<%= s.fow ? 'enbl' : 'dsbl' %>">Fog of War</div>
  <div data-flag="forcelight" class="<%= s.forcelight ? 'enbl' : 'dsbl' %>">Force Light</div>
  <div data-flag="friendlyfire" class="<%= s.friendlyfire ? 'enbl' : 'dsbl' %>">Friendly Fire</div>
  <div data-flag="recoil" class="<%= s.recoil ? 'enbl' : 'dsbl' %>">Dyn Recoil</div>
  <div data-flag="password" class="<%= s.password ? 'enbl' : 'dsbl' %>">Password</div>
  <div data-flag="usgnonly" class="<%= s.usgnonly ? 'enbl' : 'dsbl' %>">USGN Only</div>
</div>

<div class="details">
  <table class="<% if (s.gamemode == 1) { %>dm<% } else { %>ct<% } %>">
    <thead>
      <tr>
        <th>Player</th>
        <th>Score</th>
        <th>Deaths</th>
      </tr>
    </thead>
    <tbody id="ct">
      <% s.playerlist.forEach(function(p) { %>
      <% if (p.team >= 2) { %>
      <tr>
        <td><%= p.name %></td>
        <td><%= p.score %></td>
        <td><%= p.deaths %></td>
      </tr>
      <% } %>
      <% }) %>
    </tbody>
  </table>
  <table class="<% if (s.gamemode == 1) { %>dm<% } else { %>tt<% } %>">
    <thead>
      <tr>
        <th>Player</th>
        <th>Score</th>
        <th>Deaths</th>
      </tr>
    </thead>
    <tbody id="t">
      <% s.playerlist.forEach(function(p) { %>
      <% if (p.team == 1) { %>
      <tr>
        <td><%= p.name %></td>
        <td><%= p.score %></td>
        <td><%= p.deaths %></td>
      </tr>
      <% } %>
      <% }) %>
    </tbody>
  </table>
</div>

<div class="spec">
  <% if (s.playerlist && s.playerlist.filter(p => p.team == 0).length > 0) { %>
    Spectators: <%= s.playerlist.filter(p => p.team == 0).map(p => p.name).join(', ') %>
  <% } %>
</div>
<div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container details" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
      
      <table class="table-sm">
        <tbody>
          <tr><td><b>IP Address</b></td><td class="vlue"><%= s.ip %></td></tr>
          <tr><td><b>Hostname</b></td><td class="vlue"><%= s.dbg.hostname || 'N/A' %></td></tr>
          <tr><td><b>Location</b></td><td class="vlue"><%= s.dbg.city || 'N/A' %>, <%= s.dbg.country_name || 'N/A' %></td></tr>
          <tr>
            <td><b>Provider</b></td>
            <td class="vlue">
              <%= (s.dbg.org || 'N/A').split(' ').slice(1).join(' ') || 'N/A' %>
            </td>
          </tr>
          <tr>
            <td><b>Game Mode</b></td>
            <td id="gamemode" class="<%= ['s', 'd', 't', 'c', 'z'][s.gamemode] || '' %>">
              <%= ['Standard', 'Deathmatch', 'Team Deathmatch', 'Construction', 'Zombies!'][s.gamemode] %>
            </td>
          </tr>
          <tr><td><b>Lua Script</b></td><td class="<%= s.lua ? 'enbl' : 'dsbl' %>"><%= s.lua ? 'Enabled' : 'Disabled' %></td></tr>
          <tr><td><b>Downloads</b></td><td class="<%= s.hasdownloads ? 'enbl' : 'dsbl' %>"><%= s.hasdownloads ? 'Enabled' : 'Disabled' %></td></tr>
        </tbody>        
      </table>
      <table class="table-sm">
        <tbody>
          <tr><td><b>Off-Scn Dmg</b></td><td class="<%= s.offscreendamage ? 'enbl' : 'dsbl' %>"><%= s.offscreendamage ? 'Enabled' : 'Disabled' %></td></tr>
          <tr><td><b>Fog of War</b></td><td class="<%= s.fow ? 'enbl' : 'dsbl' %>"><%= s.fow ? 'Enabled' : 'Disabled' %></td></tr>
          <tr><td><b>Force Light</b></td><td class="<%= s.forcelight ? 'enbl' : 'dsbl' %>"><%= s.forcelight ? 'Enabled' : 'Disabled' %></td></tr>
          <tr><td><b>Friendly Fire</b></td><td class="<%= s.friendlyfire ? 'enbl' : 'dsbl' %>"><%= s.friendlyfire ? 'Enabled' : 'Disabled' %></td></tr>
          <tr><td><b>Password</b></td><td class="<%= s.password ? 'enbl' : 'dsbl' %>"><%= s.password ? 'Enabled' : 'Disabled' %></td></tr>
          <tr><td><b>Dyn Recoil</b></td><td class="<%= s.recoil ? 'enbl' : 'dsbl' %>"><%= s.recoil ? 'Enabled' : 'Disabled' %></td></tr>
          <tr><td><b>USGN Only</b></td><td class="<%= s.usgnonly ? 'enbl' : 'dsbl' %>"><%= s.usgnonly ? 'Enabled' : 'Disabled' %></td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>


